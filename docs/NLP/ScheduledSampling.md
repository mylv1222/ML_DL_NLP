# Scheduled Sampling 计划采样
## 背景
在进行序列生成任务Seq2Seq时，需要在给定输入的条件下，最大化生成目标序列的概率。

在训练时：模型会将目标序列中的真实元素作为解码器每一步的输入，然后再最大化下一个元素的生成概率。

在测试时：模型会将上一步解码得到的元素作为当前的输入，然后生成下一个元素。

这就出现了问题————训练阶段和测试阶段的解码器输入数据的概率分布不一致。**因为训练和测试的前一输入不同，导致可能预测时产生的序列在训练中根本没有出现过，因此在预测时模型就不知道该怎么选择。**

所以如果测试的时候序列前面生成了错误的元素，后面的生成序列错误累计将会极大影响生成序列的准确率。

## 解决方法——Scheduled Sampling 计划采样
### 主要思路
修改训练时的decoder模型，原始模型train-decoder只以真实的label作为输入，修改后的模型使用一个概率P来选择模型自身的输出作为下一个预测的输入，以1-P的概率选择真实的label作为下一个预测的输入。
**计划采样（Schedule Sampling）即让这个采样率P在训练过程中是变化的。**

> 一开始训练不充分，先让P小一些尽量使用真实的label进行训练，随着训练的进行，P增大，多用自身的输出作为下一个预测的输入。P不断随着训练的进行而增大，train-decoder越来越变得和inference-decoder预测模型一样，从而消除了两者的差异性。
